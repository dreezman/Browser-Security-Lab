<!DOCTYPE html>
<html>
  <head>
    <title>My webpage!</title>
  </head>
  <body>
    <h3>CSRF Attack!</h3>

    <p>First, lets look into the cookie jar and see what goodies we have</p>
    Opening the Cookie Jar:
    <br />---------------------------- <br />----------------------------
    <div id="cookieTemplate"></div>
    ---------------------------- <br />----------------------------

    <p>
      What is all this sameSite stuff about?
      <a href="https://andrewlock.net/understanding-samesite-cookies/">
        SameSite Details and examples</a
      >
    </p>

    <ul>
      <li>None - Send cookie on all requests</li>
      <li>
        Lax - bank.com cookies will be sent if you are on FaceBook and click
        link to your bank.com
      </li>
      <li>
        Strict - bank.com cookies will be sent only if your are on bank.com
        going to bank.com
      </li>
    </ul>
    <h2>CSRF</h2>
    Now, lets steal the login cookie

    <a href="http://localhost:3000/csrf-attack-form.html"> Load csrf form!! </a>
    <script>
      document.cookie =
        "cookieName1=This cookie is secure and sameSite=None. Can be sent anywhere over HTTPS; secure; SameSite=None";
      document.cookie =
        "cookieName2=This cookie is NOT secure and sameSite=None, over HTTP(S); SameSite=None";
      document.cookie =
        "cookieName3=This cookie is sameSite=Lax. Can follow non-sameSite page linking to sameSite page over HTTP(S); SameSite=Lax";
      document.cookie =
        "cookieName4=This cookie is sameSite=Strict. Can on be from sameSite page to sameSite page over HTTP(S); SameSite=Strict";
      document.cookie =
        "cookieName5=This cookie is sameSite=None. Can be sent anywhere over HTTPS; domain=weirdDomain.com; SameSite=None";
      document.cookie.split(";").forEach(function (c) {
        document.getElementById("cookieTemplate").innerHTML += c + "<br>";
      });
    </script>
  </body>
</html>
